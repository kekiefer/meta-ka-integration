From c45ea3efb2bd8e2a4c8e34d216b77f5a264b9e2b Mon Sep 17 00:00:00 2001
From: Kurt Kiefer <kurt.kiefer@arthrex.com>
Date: Sun, 24 Jul 2022 23:02:47 -0700
Subject: [PATCH] Fixes for yocto build workflow

---
 setup.py                     | 4 ++--
 tools/setup_helpers/cmake.py | 2 --
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/setup.py b/setup.py
index 2d434cad..18a5d7cb 100644
--- a/setup.py
+++ b/setup.py
@@ -235,7 +235,7 @@ import sysconfig
 from tools.build_pytorch_libs import build_caffe2
 from tools.setup_helpers.env import (IS_WINDOWS, IS_DARWIN, IS_LINUX,
                                      build_type)
-from tools.setup_helpers.cmake import CMake
+from tools.setup_helpers.cmake import CMake, BUILD_DIR as DEFAULT_BUILD_DIR
 from tools.generate_torch_version import get_torch_version
 
 ################################################################################
@@ -314,7 +314,7 @@ package_type = os.getenv('PACKAGE_TYPE', 'wheel')
 version = get_torch_version()
 report("Building wheel {}-{}".format(package_name, version))
 
-cmake = CMake()
+cmake = CMake(os.getenv("BUILD_DIR", DEFAULT_BUILD_DIR))
 
 
 def get_submodule_folders():
diff --git a/tools/setup_helpers/cmake.py b/tools/setup_helpers/cmake.py
index ad834e21..9eb42fc2 100644
--- a/tools/setup_helpers/cmake.py
+++ b/tools/setup_helpers/cmake.py
@@ -427,8 +427,6 @@ class CMake:
         build_args = [
             "--build",
             ".",
-            "--target",
-            "install",
             "--config",
             build_type.build_type_string,
         ]
